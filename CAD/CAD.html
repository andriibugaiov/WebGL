<!DOCTYPE html>
<html>
<head>
<script id="vertex-shader" type="x-shader/x-vertex">
attribute vec4 vPosition;
attribute vec4 vColor;

varying vec4 fColor;

void main() {
	fColor = vColor;
    gl_Position = vPosition;
}
</script>

<script id="fragment-shader" type="x-shader/x-fragment">
precision mediump float;

varying vec4 fColor;

void main() {
    gl_FragColor = fColor;
}
</script>

<script type="text/javascript" src="../Common/webgl-utils.js"></script>
<script type="text/javascript" src="../Common/initShaders.js"></script>
<script type="text/javascript" src="../Common/MV.js"></script>

<script type="text/javascript" src="paint.js"></script>
<script>
	var demonstrator = null;
	window.onload = function initDemonstrator() {
		demonstrator = new Demonstrator();
	};
</script>
</head>

<body>
<div>
	Color: 
	<input type="radio" name="color" value="0" checked>Black
	<input type="radio" name="color" value="1" >Red
	<input type="radio" name="color" value="2">Green
	<input type="radio" name="color" value="3">Blue
</div>

<script>
	var colors = [
		vec3(0, 0, 0),
		vec3(1, 0, 0),
		vec3(0, 1, 0),
		vec3(0, 0, 1)
	];

	var handler = function (event) {
		var radio = event.target;
		if(radio.checked == true) {
			if (demonstrator) {
				var color = colors[radio.value];
				demonstrator.onColorSelected(color);
			}
	    }
	};

	var radios = document.getElementsByName("color");
	for(var i = 0; i < radios.length; ++i) {
		radios[i].onchange = handler;
    }
</script>

<div>
	<canvas id="gl-canvas" width="512" height="512" style="border: solid">
		Oops ... your browser doesn't support the HTML5 canvas element
	</canvas>
</div>

<script>
	var shouldTrack = false;

	var convert = function (event) {
		var x = -1 + 2 * event.layerX / canvas.width;
		var y = -1 + 2*(canvas.height - event.layerY)/canvas.height;
		return vec2(x, y);
	};

	var canvas = document.getElementById("gl-canvas");
	canvas.addEventListener("mousedown", function (event) {
		if (demonstrator) {
			var point = convert(event);
			demonstrator.onPointTrackStarted(point);
		}
		shouldTrack = true;
	});

	canvas.addEventListener("mouseup", function (event) {
		shouldTrack = false;
		if (demonstrator) {
			var point = convert(event);
			demonstrator.onPointTrackEnded(point);
		}
	});

	// canvas.addEventListener("mouseout", function (event) {
	// 	shouldTrack = false;
	// 	if (demonstrator) {
	// 		var point = convert(event);
	// 		demonstrator.onPointTrackEnded(point);
	// 	}
	// });

	canvas.addEventListener("mousemove", function (event) {
		if (shouldTrack) {
			if (demonstrator) {
				var point = convert(event);
				// console.log(point);
				demonstrator.onPointTracked(point);
			}
		}
	});
	onPointTrackOut
</script>

<div>
	Author: Andrii Bugaiov
</div>

</body>
</html>
