<!DOCTYPE html>
<html>
<head>
<script id="vertex-shader" type="x-shader/x-vertex">
uniform mat4 matrix;
uniform vec4 color;

attribute vec3 vPosition;
// attribute vec4 vColor;

varying vec4 fColor;

void main() {
    gl_Position = matrix * vec4(vPosition, 1.0);
    
    fColor = color;
    // fColor = vColor;
}
</script>

<script id="fragment-shader" type="x-shader/x-fragment">
precision mediump float;

varying vec4 fColor;

void main() {
    gl_FragColor = fColor;
}
</script>

<script type="text/javascript" src="../Common/webgl-utils.js"></script>
<script type="text/javascript" src="../Common/initShaders.js"></script>
<script type="text/javascript" src="../Common/MV.js"></script>

<script type="text/javascript" src="Sphere.js"></script>
<script type="text/javascript" src="CAD.js"></script>
<script>
	var demonstrator = null;
	window.onload = function initDemonstrator() {
		demonstrator = new Demonstrator();
	};
</script>
</head>

<body>
<div>
<div>
	Shape:
	<input type="radio" name="shape" value="sphereID" checked>Sphere
	<input type="radio" name="shape" value="coneID">Cone
	<input type="radio" name="shape" value="cylinderID">Cylinder
</div>
<div>
	Scale:
	<input id="scaleXYZ" type="range" 
	min="0.0" 
	max="0.5" 
	step="0.01" />
	<input id="boxScale" type="text" />
</div>
<div>
	Position 'x':
	<input id="posX" type="range" 
	min="-0.5" 
	max="0.5" 
	step="0.01" />
	<input id="boxPosX" type="text" />
</div>	
<div>
	Position 'y':
	<input id="posY" type="range" 
	min="-0.5" 
	max="0.5" 
	step="0.01" />
	<input id="boxPosY" type="text" />
</div>	
<div>
	Position 'z':
	<input id="posZ" type="range" 
	min="-0.5" 
	max="0.5" 
	step="0.01" />
	<input id="boxPosZ" type="text" />
</div>

<div>
	<div>
		Rotation:
		<input type="radio" name="axis" value="x" checked>'x'
		<input type="radio" name="axis" value="y">'y'
		<input type="radio" name="axis" value="z">'z'
	</div>
	<div>
		Angle:
		<input id="angle" type="range" 
		min="-180" 
		max="180" 
		step="0.01" />
		<input id="boxAngle" type="text" />
	</div>
</div>

<div>
	<button id="add" type="button">Add Shape</button>
</div>
</div>

<div>
	<canvas id="gl-canvas" width="512" height="512" style="border: solid">
		Oops ... your browser doesn't support the HTML5 canvas element
	</canvas>
</div>

<script>
// mark - scale	

	var scaleXYZ = document.getElementById("scaleXYZ");
	var boxScale = document.getElementById("boxScale");
	boxScale.value = scale.value = 0.25;
	scaleXYZ.addEventListener("change", function (event) {
		boxScale.value = event.target.value;
	});
	scaleXYZ.addEventListener("input", function (event) {
		boxScale.value = event.target.value;
	});

// mark - position

	var posX = document.getElementById("posX");
	var boxPosX = document.getElementById("boxPosX");
	boxPosX.value = posX.value = 0.0;
	posX.addEventListener("change", function (event) {
		boxPosX.value = event.target.value;
	});
	posX.addEventListener("input", function (event) {
		boxPosX.value = event.target.value;
	});

	var posY = document.getElementById("posY");
	var boxPosY = document.getElementById("boxPosY");
	boxPosY.value = posY.value = 0.0;
	posY.addEventListener("change", function (event) {
		boxPosY.value = event.target.value;
	});
	posY.addEventListener("input", function (event) {
		boxPosY.value = event.target.value;
	});

	var posZ = document.getElementById("posZ");
	var boxPosZ = document.getElementById("boxPosZ");
	boxPosZ.value = posZ.value = 0.0;
	posZ.addEventListener("change", function (event) {
		boxPosZ.value = event.target.value;
	});
	posZ.addEventListener("input", function (event) {
		boxPosZ.value = event.target.value;
	});

// mark - rotation

	var angle = document.getElementById("angle");
	var boxAngle = document.getElementById("boxAngle");
	boxAngle.value = angle.value = 0.0;
	angle.addEventListener("change", function (event) {
		boxAngle.value = event.target.value;
	});
	angle.addEventListener("input", function (event) {
		boxAngle.value = event.target.value;
	});


// mark - add shape

	var add = document.getElementById("add");
	add.addEventListener("click", function (event) {
		var s = Number(scaleXYZ.value);
		
		var x = Number(posX.value);
		var y = Number(posY.value);
		// TODO!
		var z = -Number(posZ.value);

		var a = Number(angle.value);
		var axOptions = {
			"x": vec3(1.0, 0.0, 0.0),
			"y": vec3(0.0, 1.0, 0.0),
			"z": vec3(0.0, 0.0, 1.0)
		};
		var ax = axOptions["x"];
		var radiosAxis = document.getElementsByName("axis");
		for(var i = 0; i < radiosAxis.length; ++i) {
			var radio = radiosAxis[i];
			if(radio.checked == true) {
				ax = axOptions[radio.value];
				break;
		    }
	    }

		var uniforms = {
            position: vec3(x, y, z),
            scale: vec3(s, s, s),
            rotation: {
                axis: ax,
                angle: a
            }        
        };

        var shapeID = null;
		var radiosShape = document.getElementsByName("shape");
		for(var i = 0; i < radiosShape.length; ++i) {
			var radio = radiosShape[i];
			if(radio.checked == true) {
				shapeID = radio.value;
				break;
		    }
	    }

	    if (demonstrator && shapeID) {
	    	demonstrator.addShape(shapeID, uniforms);
	    }
	});
</script>

<div>
	Author: Andrii Bugaiov
</div>

</body>
</html>
